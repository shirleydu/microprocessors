Intro:

This lab explores the interfacing of the c8051 microcontroller with different types of external RAM. External memory can be accessed using Ports 5 and 6 as an address bus, Port 7 as a data bus, and P4.6 and P4.7 as read and write enables respectively. The addresses 0x0000 to 0x1FFF are internal to the c8051, after which the microcontroller looks to external memory. The two types of RAM used for this lab were the Am9128, a 2k x 8-bit memory chip, and the MCM6147, a 4k x 1-bit memory chip. Since these chips are old, the clock must be slowed down to accomodate the read/write latency of the chips.

Materials/Procedure:

Part 1 of this lab makes sure everything works and is properly set up; one Am9128 chip is wired to the microcontroller, with the lower 8 address bits connected to P6, the higher 3 connected to P5, and the data lines connected to P7. The higher 5 bits of the address bus are used in the glue logic to enable the chip when writing to the range of 0x2000-0x27FF (see attached diagrams for more information). To make sure the chip is working correctly, data is written to the chip and read back and printed out. In proper operation, read/write should be possible while the chip is being powered, and 0xFF should be read back when power is off (as unknown bits tend to float high). 

Part 2 of this lab checks that data is written correctly to the external memory. With the same hardware setup as Part 1, 0x55 is written to addresses 0x2000 to 0x27FF and read back. If the read is different from the write, the address at which this occurred is written to a buffer array of length 256. If this buffer fills (ie. contains 256 elements), its contents are dumped to the screen and emptied; otherwise, the errors are printed once the program has finished writing to all addresses. If everything works as expected, for addresses 0x2000 to 0x27FF, no errors should occur. Beyond this, if no more memory is added to accept these writes/reads-- or if the chip is not powered, errors will occur from 0xFF being read back (for the reason stated above).

In part 3, additional memory is added, in the form of the MCM6147 chip(s) to hold addresses 0x3000 to 0x3FFF. The address bus, data line (8 chips x one data line each for a full byte), and read/write enables are connected to the same as for the Am9128. The top 4 bits of the address bus are used in glue logic to enable the chip in its designated range. If everything is done correctly, writing 2 bytes to the 0x2000-0x27FF range will read back the same data, writing to the 0x2800-0x2FFF range will read back 0xFF, as no memory is associated with those addresses, and writing to the 0x3000-0x3FFF range will read back as many bits as MCM6147 chips wired up, with the remaining bits of the full 2 bytes being HIGH.